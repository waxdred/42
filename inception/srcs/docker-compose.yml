# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    docker-compose.yml                                 :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: jmilhas <jmilhas@student.42.fr>            +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2022/06/07 22:22:47 by jmilhas           #+#    #+#              #
#    Updated: 2022/06/07 23:24:30 by jmilhas          ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

version: "3,8"

services:
  #==================== Nginx=====================#
  nginx:
    networks: 
      - inception
    container_name: nginx
    build:  nginx
    image:  nginx
    volumes:
      - ${VOLPATH}/workpress:/var/www/workpress/
    ports:
      - "443:443"
    restart: always

  mariadb:
    env_file:
      - .env
    container_name: mariadb
    hostname: mariadb
    build: mariadb
    image: mariadb
    environment:
      MYSQL_ROOT_PASSWORD:  ${MYSQL_ROOT_PASSWORD}
      WORDPRESS_HOST:       ${WORDPRESS_HOST}
      WORDPRESS_DB_NAME:       ${WORDPRESS_DB_NAME}
      WORDPRESS_DB_USER:       ${WORDPRESS_DB_USER}
      WORDPRESS_DB_PASSWORD:   ${WORDPRESS_DB_PASSWORD}
    # volumes:                    
    #   - ${VOLPATH}/mariadb:/var/lib/mysql/
    ports:
      - "3306:3306"
    networks:
      - inception
    restart: always

  workpress:
    container_name: ${WORDPRESS_HOST}
    build: workpress
    image: workpress
    hostname: ${WORDPRESS_HOST}
    networks: 
      - inception
    restart: always


networks:
  inception:
    driver: bridge

# volumes:
#   volume-mariadb:
#     driver: local
#     driver_opts:
#       type: 'none'
#       o: 'bind'
#       device: ${VOLPATH}/mariadb
  
#   volume-workpress:
#     driver: local
#     driver_opts:
#       type: 'none'
#       o: 'bind'
#       device: ${VOLPATH}/workpress
    
